# WAi Championship

WAi 챗봇 활성화를 위한 전사 이벤트 페이지입니다.

## 🎯 프로젝트 개요

3~5개 팀이 20개의 목표 답변을 맞추는 게임 이벤트입니다. **리버스 엔지니어링 방식**으로, 참가자들은 목표 답변을 보고 WAi 챗봇에서 해당 답변이 나오도록 질문을 만들어야 합니다. WAi의 답변과 목표 답변의 유사도를 기반으로 점수를 받습니다.

## 🚀 시작하기

### 설치

```bash
npm install
```

### 개발 서버 실행

```bash
npm run dev
```

브라우저에서 [http://localhost:3000](http://localhost:3000)을 엽니다.

### 빌드

```bash
npm run build
npm start
```

## 📱 페이지 구성

### 1. 홈 페이지 (`/`)
- 관리자, 참가자, 관전자 페이지로 이동하는 메인 허브

### 2. 관리자 페이지 (`/admin`)
관리자가 게임을 설정하고 관리하는 페이지입니다.

**기능:**
- **현황 탭**: 전체 게임 현황 및 팀 순위 확인
- **팀 관리 탭**:
  - 팀 등록 (팀명, 팀원, 비밀번호)
  - 팀 삭제
  - 팀 통계 확인
- **답변 관리 탭**:
  - 목표 답변 개별 등록
  - 목표 답변 일괄 등록 (각 줄에 하나씩)
  - 답변 삭제
- **게임 제어 탭**:
  - 게임 상태 변경 (준비중/진행중/종료)
  - 게임 초기화

**사용 순서:**
1. 팀 관리 탭에서 참가 팀 등록
2. 답변 관리 탭에서 20개 목표 답변 등록
3. 게임 제어 탭에서 게임 시작

### 3. 팀 참가 페이지 (`/team/login` → `/team/[teamId]`)

**로그인 페이지 (`/team/login`):**
- 팀 선택
- 비밀번호 입력

**게임 페이지:**
- 20개 목표 답변 순차 확인
- 목표 답변이 나오도록 질문 만들기
- 만든 질문과 WAi 답변 제출
- 실시간 점수 확인 (0-10점)
- 진행률 표시
- 문제 네비게이션

**WAi 사용 방법 (리버스 엔지니어링):**
1. 이벤트 페이지에서 **목표 답변** 확인
   - 예: "더 나은 세상을 만드는 연결"
2. https://www.wadiz.kr/web/wai 접속
3. 해당 답변이 나오도록 **여러 질문을 시도**
   - 예: "와디즈의 비전은?", "와디즈 비전 알려줘" 등
4. 가장 유사한 답변이 나오면
5. **만든 질문**과 **WAi의 답변**을 이벤트 페이지에 입력
6. 제출 → WAi 답변과 목표 답변의 유사도로 자동 점수 계산

### 4. 관전자 페이지 (`/scoreboard`)
대형 스크린에 표시하기 위한 실시간 스코어보드입니다.

**기능:**
- 실시간 팀 순위 (애니메이션)
- 팀별 진행률 표시
- 최근 제출 내역 표시:
  - 목표 답변
  - 각 팀이 만든 질문
  - WAi의 답변
  - 점수
- 답변에 대한 반응 (👍 👏 🔥 ❤️ 😂)
- 반응 실시간 집계
- 2초마다 자동 갱신

## 🎮 게임 진행 플로우

### 사전 준비 (관리자)
1. `/admin` 접속
2. 팀 관리 → 참가 팀 등록 (예: 개발팀, 디자인팀, 마케팅팀)
3. 답변 관리 → 20개 목표 답변 등록
   - 개별 등록 또는
   - 일괄 등록 (각 줄에 하나씩):
     ```
     더 나은 세상을 만드는 연결
     서울시 강남구
     2012년
     ```

### 게임 시작
1. 관리자: 게임 제어 → "게임 시작" 클릭
2. 각 팀: `/team/login`에서 로그인
3. 대형 스크린: `/scoreboard` 표시

### 게임 진행 (리버스 엔지니어링 방식)
1. 팀원들이 **목표 답변** 확인
   - 예: "더 나은 세상을 만드는 연결"
2. https://www.wadiz.kr/web/wai 에서 해당 답변이 나오도록 **질문을 만듦**
   - 시도: "와디즈의 비전은?", "와디즈 가치관은?" 등
3. 가장 유사한 답변이 나왔다고 판단되면
4. **만든 질문**과 **WAi의 답변**을 이벤트 페이지에 입력
5. 제출 → 자동으로 점수 계산 (WAi 답변과 목표 답변의 유사도, 0-10점)
6. 다음 문제로 진행

### 관전
- 관전자들은 스코어보드에서:
  - 실시간 순위 확인
  - 각 팀이 만든 질문 확인
  - WAi의 답변과 점수 확인
  - 팀 답변에 반응 클릭 가능 (👍 👏 🔥 ❤️ 😂)
- 반응 통계 실시간 표시

### 게임 종료
1. 모든 팀이 20개 문제 완료 또는
2. 관리자가 "게임 종료" 클릭
3. 최종 순위 확인

## 🔧 기술 스택

- **Frontend**: Next.js 14 (App Router), React, TypeScript
- **Styling**: Tailwind CSS
- **Animation**: Framer Motion
- **Similarity**: string-similarity (Dice's Coefficient)
- **Data Storage**: 로컬 파일 저장 (JSON, 서버 재시작 후에도 데이터 유지)
- **Real-time**: 2-3초 폴링

## 📊 점수 계산 방식

### Similarity 알고리즘
- **알고리즘**: Dice's Coefficient (string-similarity 라이브러리)
- **정규화**:
  - 소문자 변환
  - 앞뒤 공백 제거
  - 연속 공백을 하나로
- **점수 범위**: 0-10점 (소수점 1자리)
- **완전 일치**: 10점
- **유사도 변환**: 유사도(0~1) × 10 = 점수(0~10)

### 피드백 메시지
- 9.5~10점: 완벽합니다! 🎉
- 8.5~9.4점: 훌륭해요! 🌟
- 7.0~8.4점: 잘했어요! 👏
- 5.0~6.9점: 좋습니다! 👍
- 3.0~4.9점: 아쉬워요 😅
- 0~2.9점: 다시 시도해보세요 💪

## 🎨 주요 기능

### 실시간 업데이트
- 모든 페이지에서 2-3초마다 자동 갱신
- 순위 변동 시 애니메이션 효과

### 반응 시스템
- 5가지 반응 타입: 좋아요, 박수, 불, 하트, 웃음
- 실시간 집계 및 표시
- 관전자 참여 유도

### 애니메이션
- Framer Motion을 활용한 부드러운 전환
- 순위 변동 애니메이션
- 점수 제출 시 피드백 애니메이션

## 🔒 보안 고려사항

**주의**: 이 애플리케이션은 내부 이벤트용으로 설계되었습니다.

- 팀 비밀번호는 평문으로 저장됩니다
- 로컬 파일 기반 저장 (`data/game-state.json`)
- 프로덕션 환경에서는 적절한 인증 및 데이터베이스 사용 권장

## 💾 데이터 저장 및 동기화

### 파일 기반 저장소
- **저장 위치**: `data/game-state.json`
- **자동 저장**: 모든 데이터 변경 시 자동으로 파일에 저장
- **자동 로드**: 서버 시작 시 파일에서 데이터 자동 로드
- **서버 재시작 후 데이터 유지**: ✅ 지원

### 저장되는 데이터
```typescript
{
  status: '준비중' | '진행중' | '종료',
  teams: Team[],           // 팀 정보 및 답변
  questions: Question[],   // 질문 및 정답
  reactions: Reaction[],   // 관전자 반응
  startedAt?: Date,        // 게임 시작 시간
  endedAt?: Date          // 게임 종료 시간
}
```

### 동기화 동작
- 팀 추가/수정/삭제 → 즉시 파일 저장
- 질문 추가/수정/삭제 → 즉시 파일 저장
- 답변 제출 → 즉시 파일 저장
- 반응 추가 → 즉시 파일 저장
- 게임 상태 변경 → 즉시 파일 저장

### 데이터 백업
중요한 이벤트 전에 `data/game-state.json` 파일을 백업하는 것을 권장합니다:
```bash
cp data/game-state.json data/game-state.backup.json
```

### API 엔드포인트
- `GET/POST /api/game` - 게임 상태 관리
- `GET/POST /api/teams` - 팀 관리
- `GET/POST /api/questions` - 질문 관리
- `POST /api/answers` - 답변 제출
- `GET/POST /api/reactions` - 반응 관리
- `GET /api/poll` - 폴링용 엔드포인트

## 🎯 성능

- 동시 접속: 200명 이상 지원
- 폴링 주기: 2-3초
- 응답 시간: < 100ms (로컬)
- 파일 저장: 각 변경마다 자동 저장 (비동기 I/O)

## 🐛 트러블슈팅

### 서버가 시작되지 않을 때
```bash
rm -rf .next node_modules
npm install
npm run dev
```

### 데이터 복구가 필요할 때
데이터 파일이 손상되었거나 초기화가 필요한 경우:
```bash
# 현재 데이터 백업 (옵션)
cp data/game-state.json data/game-state.backup.json

# 데이터 파일 삭제 (새로 시작)
rm data/game-state.json

# 서버 재시작 - 새로운 빈 파일 생성됨
npm run dev
```

### 백업에서 복구
```bash
# 백업 파일이 있는 경우
cp data/game-state.backup.json data/game-state.json
npm run dev
```

### 스코어보드가 업데이트되지 않을 때
- 브라우저 새로고침
- 개발자 도구에서 네트워크 오류 확인
- 서버 콘솔에서 에러 로그 확인

## 📄 라이선스

MIT

## 👥 개발

Built with ❤️ for Wadiz WAi Championship Event
